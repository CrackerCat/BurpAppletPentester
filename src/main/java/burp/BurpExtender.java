package burp;

//import ui.DescryptUI;
import ui.BurpSendMenuFactory;
import ui.CryptUI;

import javax.swing.*;
import java.awt.*;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.List;

public class BurpExtender implements IBurpExtender, ITab {

    private PrintWriter stdout;

    private PrintWriter stderr;

    public IBurpExtenderCallbacks callbacks;

    private JScrollPane optionsTab;

    private JPanel panel;

    public void registerExtenderCallbacks(IBurpExtenderCallbacks callbacks) {
        this.callbacks = callbacks;
        callbacks.setExtensionName("SessionKey Crypt");
        stdout = new PrintWriter(callbacks.getStdout(), true);
        stderr = new PrintWriter(callbacks.getStderr(), true);
        stdout.println("Import successfully!!!");
        stdout.println("Project Address:https://github.com/mrknow001/BurpAppletPentester");


        SwingUtilities.invokeLater(() -> {
            panel = new CryptUI(this);
            optionsTab = new JScrollPane(panel, ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED, ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED);
            optionsTab.setPreferredSize(new Dimension(600, 600));
            optionsTab.getVerticalScrollBar().setUnitIncrement(20);
            callbacks.addSuiteTab(this);

        });

        callbacks.registerContextMenuFactory(new BurpSendMenuFactory(this));

    }



    @Override
    public String getTabCaption() {
        return "AppletPentester";
    }

    @Override
    public Component getUiComponent() {
        return optionsTab;
    }

}
